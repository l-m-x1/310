<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="./css/iconfont.css">
    <link rel="stylesheet" href="./css/mainspace.css">
    <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
    <script src="js/vue.js"></script>
    <script src="element-ui/lib/index.js"></script>
    <link rel="stylesheet" href="element-ui/lib/theme-chalk/index.css">
    <script src="js/axios-0.18.0.js"></script>
    <style>
        #in{
            top: 20px;
            position: relative;
        }
        #button1{
            left: 20px;
            position: relative;
        }
        #button2{
            left: 40px;
            position: relative;
        }
        #date{


        }
    </style>
</head>
<body>

<ul class="topNav">
    <li ><a href="#home"><span class="iconfont icon-gerenziliao">个人中心</span></a></li>
    <li>
        <div class="friendListTrigger">
            <a href="#news"><span class="iconfont icon-haoyouliebiao">好友列表</span></a>
        </div>
    </li>

    <li style="float: right" ><a href="#about"><span class="iconfont icon-logout"></span></a></li>

    <li style="float: right" >
        <div id="settingTrigger">
            <a href="#about"><span class="iconfont icon-shezhi"></span></a>
        </div>
    </li>
</ul>
<div class="friendList">
</div>
<div id="setting">
    <li><a href="personalProfile.html">修改资料</a></li>
    <li><a href="permissionManagement.html">权限管理</a></li>
</div>


<ul class="midNav">
    <li><a href="#home" class="active">主页</a></li>
    <li><a href="#news">相册</a></li>
    <li><a href="#contact">日志</a></li>
    <li><a href="#contact">留言版</a></li>
    <li><a href="#contact">个人心情</a></li>
</ul>

<div class="row">
    <div class="leftcolumn">


        <div id="avatar">
            <el-avatar :size="100" src="https://empty" @error="errorHandler">
                <img src="./img.png"/>
            </el-avatar>
        </div>

        <div class="card">
            <h2>About Me</h2>
            <div class="fakeimg" style="height:100px;">Image</div>
            <p>Some text about me in culpa qui officia deserunt mollit anim..</p>
        </div>

    </div>
    <div class="rightcolumn">
        <div id="app">
            <el-form id="date" ref="form" :model="form" label-width="80px">
                <el-row >
                    <span id="button1" class="demonstration"><i class="el-icon-edit"></i>写日志</span>
                    <el-button id="button2" type="info" plain>返回日志列表</el-button>
                </el-row>
                <hr>
                <el-form :model="ruleForm" :rules="rules"  id="in" ref="ruleForm" label-width="100px" class="demo-ruleForm">
                    <el-form-item label="日志标题" prop="name">
                        <el-input v-model="ruleForm.name" placeholder="请输入标题"></el-input>
                    </el-form-item>
                    <el-form-item label="日志内容" prop="desc">
                        <el-input
                                type="textarea"
                                :autosize="{ minRows: 6, maxRows: 100}"
                                placeholder="请输入内容"
                                v-model="ruleForm.desc">
                        </el-input>
                    </el-form-item>
                    <el-form-item>
                        <el-button type="primary" @click="submitForm('ruleForm')">确认发表</el-button>
                        <el-button @click="resetForm('ruleForm')">清空</el-button>
                    </el-form-item>

                </el-form>
            </el-form>
        </div>
    </div>
</div>




<script>
    //set button
    $(".friendListTrigger").mouseenter(function (){
        $(".friendList").prop("style","display:block");
    });

    $(".friendList").mouseleave(function (){
        $(".friendList").prop("style","display:none");
    });

    $("#settingTrigger").click(function ()
    {
        $("#setting").prop("style","display:block");
    });

    $("#setting").mouseleave(function (){
        $("#setting").prop("style","display:none");
    });



    //logout
    $(".topNav .icon-logout").click(function (){
        axios({
            method:'get',
            url:''
        }).then(resp=>{
            document.location="./login.html";
        });

    });


    //get friend List
    class Friend{
        constructor(url,avatar,name) {
            this.url=url;
            this.avatar=avatar;
            this.name=name;
        }
    };
    let friendList=[];
    axios({
        method: "get",
        url:''
    }).then(resp=>{
        let list=resp.data;
        list.forEach(item=>{
            friendList.push(new Friend(item.url,item.avatar,item.name));
        })
    });

    friendList.push(new Friend("www.baidu.com","./img.png","zhuangsan"));
    friendList.push(new Friend("","./img.png","lisi"));
    friendList.push(new Friend("","./img.png","lisi"));
    friendList.push(new Friend("","./img.png","lisi"));
    friendList.push(new Friend("","./img.png","lisi"));
    friendList.push(new Friend("","./img.png","lisi"));
    friendList.push(new Friend("","./img.png","lisi"));

    let friends = $(".friendList");
    friendList.forEach(item=>{
        let friend="<a target=\"_blank\" href=\""+item.url+"\">\n" +
            "        <div class=\"friend\">\n" +
            "\n" +
            "            <img class=\"friendAvatar\" src=\""+item.avatar+"\"  width=\"50\" height=\"50\" style=\"float: left\">\n" +
            "\n" +
            "            <div class=\"friendName\">"+item.name+"</div>\n" +
            "\n" +
            "        </div>\n" +
            "    </a>";
        friends.append(friend);
    })


    //set avatar and username
    new Vue ({
        el: "#avatar",
        mounted(){
            this.getUserInfo();
        },

        data(){
            return {
                userAvatar:'',
                useName:''
            }
        },

        methods: {

            getUserInfo(){
                axios({
                    method:"get",
                    url:'',

                }).then(resp=>{
                    this.userAvatar=resp.data.userAvatar;
                    this.userName=resp.data.userName;
                });

                $("#avatar el-avatar img").prop("src",this.userAvatar)
                $("#userName").text(this.userName);
            },

            errorHandler() {
                return true
            }
        }
    });
    new Vue({
        el: '#app',
        data() {
            return {
                ruleForm: {
                    name: '',
                    desc: ''
                },
                rules: {
                    name: [
                        { required: true, message: '请填写标题', trigger: 'blur' }
                    ],
                    desc: [
                        { required: true, message: '请填写内容', trigger: 'blur' }
                    ]
                }
            };
        },
        methods: {
            submitForm(formName) {
                this.$refs[formName].validate((valid) => {
                    if (valid) {
                        alert('提交成功!');
                    } else {
                        console.log('提交失败!!');
                        return false;
                    }
                });
            },
            resetForm(formName) {
                this.$refs[formName].resetFields();
            }
        }
    })
</script>
</body>
</html>