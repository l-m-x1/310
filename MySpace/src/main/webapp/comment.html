<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <link rel="stylesheet" href="./css/iconfont.css">
  <link rel="stylesheet" href="./css/mainspace.css">
  <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
  <style>
    #comment{
      right: 100px;
      position: relative;
    }
    html {
      background: bisque;
    }

    #button1{
      left: 20px;
      position: relative;
    }
    #date{
      margin-left: 20%;
      max-width: 900px;

    }
    img {
      position: relative;
      float: left;
    }

    #text1{
      vertical-align: top;
      font-size:20px;
    }

    #text2{
      left: 5%;
      position: relative;
      font-size:7px;
    }
    #text3 {
      width: 300px;
      height: 100px;
      top: 10px;
    }
    #text4{
      position: relative;
      font-size:7px;
      top: 200px;
    }
    #text5{
      position: relative;
      font-size:7px;
      top: 200px;
      left: 10%;
    }
    #in{
      position: relative;
      top: 20px;
    }

    .div1 {
      height: 300px;
      border: 1px solid blue;
    }
    .div1 span{
      left: 20px;
      position: relative;
    }
  </style>
</head>
<body>

<ul class="topNav">
  <li ><a href="#home"><span class="iconfont icon-gerenziliao">个人中心</span></a></li>
  <li>
    <div class="friendListTrigger">
      <a href="#news"><span class="iconfont icon-haoyouliebiao">好友列表</span></a>
    </div>
  </li>

  <li style="float: right" ><a href="#about"><span class="iconfont icon-logout"></span></a></li>

  <li style="float: right" >
    <div id="settingTrigger">
      <a href="#about"><span class="iconfont icon-shezhi"></span></a>
    </div>
  </li>
</ul>
<div class="friendList">
</div>
<div id="setting">
  <li><a href="personalProfile.html">修改资料</a></li>
  <li><a href="permissionManagement.html">权限管理</a></li>
</div>


<ul class="midNav">
  <li><a href="#home" class="active">主页</a></li>
  <li><a href="#news">相册</a></li>
  <li><a href="#contact">日志</a></li>
  <li><a href="#contact">留言版</a></li>
  <li><a href="#contact">个人心情</a></li>
</ul>

<div class="row">
  <div class="leftcolumn">
    <div id="avatar" class="demo-type" >
      <el-avatar :size="100" src="https://empty" @error="errorHandler">
        <img src="./img.png"/>
      </el-avatar>
    </div>
    <div class="card">
      <h2>About Me</h2>
      <div class="fakeimg" style="height:100px;">Image</div>
      <p>Some text about me in culpa qui officia deserunt mollit anim..</p>
    </div>

  </div>
  <div class="rightcolumn">
    <div id="comment">
      <el-form id="date" ref="form" :model="form" label-width="80px" >
        <el-row >
          <span id="button1" class="demonstration"><i class="el-icon-edit-outline"></i>留言板</span>
        </el-row>
        <hr>
        <ul>
          <li v-for="commentData in commentDatas">
            <div>
              <div class="div1">
                <p><img src="https://ts1.cn.mm.bing.net/th/id/R-C.86a0fa17b9b37ff7518b552e2517a0ae?rik=CX0%2fMchuLIBQVA&riu=http%3a%2f%2fimg.crcz.com%2fallimg%2f201809%2f11%2f1536666825645562.jpg&ehk=g6IGr0cDabvrRd5KSQdbup2trGpltKDfA7Hx7eopcm0%3d&risl=&pid=ImgRaw&r=0&sres=1&sresct=1"
                        alt="W3School"
                        style="width:100px;
                height:100px;
                margin-left:10px;">

                  <span id="text1">{{commentData.name}}</span>
                  <span id="text2">第{{commentData.id}}楼</span>

                  <br>
                  <span id="text3">{{commentData.text}}</span>
                  <br>
                  <span id="text4">
              {{commentData.time}}
            </span>
                  <span id="text5">
                   <el-button type="text" @click="showToggle">回复</el-button>
            </span>
                </p>
              </div>
              <el-form :model="commentData" :rules="rules"  id="in" ref="commentData" label-width="100px" class="demo-commentData" v-show="isShow">
                <el-form-item label="回复内容" prop="desc">
                  <el-input
                          type="textarea"
                          :autosize="{ minRows: 6, maxRows: 100}"
                          placeholder="请输入内容"
                          v-model="commentData.desc">
                  </el-input>
                </el-form-item>
                <el-form-item>
                  <el-button type="primary" @click="submitForm('commentData')">确认</el-button>
                  <el-button @click="resetForm('commentData')">清空</el-button>
                </el-form-item>
              </el-form>
            </div>
            <br>
            <br>
          </li>
        </ul>

      </el-form>

    </div>


  </div>
</div>




<script src="js/vue.js"></script>
<script src="element-ui/lib/index.js"></script>
<link rel="stylesheet" href="element-ui/lib/theme-chalk/index.css">
<script src="js/axios-0.18.0.js"></script>
<script>
  //set button
  $(".friendListTrigger").mouseenter(function (){
    $(".friendList").prop("style","display:block");
  });

  $(".friendList").mouseleave(function (){
    $(".friendList").prop("style","display:none");
  });

  $("#settingTrigger").click(function ()
  {
    $("#setting").prop("style","display:block");
  });

  $("#setting").mouseleave(function (){
    $("#setting").prop("style","display:none");
  });



  //logout
  $(".topNav .icon-logout").click(function (){
    axios({
      method:'get',
      url:''
    }).then(resp=>{
      document.location="./login.html";
    });

  });


  //get friend List
  class Friend{
    constructor(url,avatar,name) {
      this.url=url;
      this.avatar=avatar;
      this.name=name;
    }
  };
  let friendList=[];
  axios({
    method: "get",
    url:''
  }).then(resp=>{
    let list=resp.data;
    list.forEach(item=>{
      friendList.push(new Friend(item.url,item.avatar,item.name));
    })
  });

  friendList.push(new Friend("www.baidu.com","./img.png","zhuangsan"));
  friendList.push(new Friend("","./img.png","lisi"));
  friendList.push(new Friend("","./img.png","lisi"));
  friendList.push(new Friend("","./img.png","lisi"));
  friendList.push(new Friend("","./img.png","lisi"));
  friendList.push(new Friend("","./img.png","lisi"));
  friendList.push(new Friend("","./img.png","lisi"));

  let friends = $(".friendList");
  friendList.forEach(item=>{
    let friend="<a target=\"_blank\" href=\""+item.url+"\">\n" +
            "        <div class=\"friend\">\n" +
            "\n" +
            "            <img class=\"friendAvatar\" src=\""+item.avatar+"\"  width=\"50\" height=\"50\" style=\"float: left\">\n" +
            "\n" +
            "            <div class=\"friendName\">"+item.name+"</div>\n" +
            "\n" +
            "        </div>\n" +
            "    </a>";
    friends.append(friend);
  })


  //set avatar and username
  new Vue ({
    el: "#avatar",
    mounted(){
      this.getUserInfo();
    },

    data(){
      return {
        userAvatar:'',
        useName:''
      }
    },

    methods: {

      getUserInfo(){
        axios({
          method:"get",
          url:'',

        }).then(resp=>{
          this.userAvatar=resp.data.userAvatar;
          this.userName=resp.data.userName;
        });

        $("#avatar el-avatar img").prop("src",this.userAvatar)
        $("#userName").text(this.userName);
      },

      errorHandler() {
        return true
      }
    }
  });

  new Vue({
    el: '#comment',
    mounted(){
      //选择函数this.selectAll();
      var _this=this;
      axios({
        method:"get",
        url:''//网站"http://localhost:8080/brand-case/selectAllServlet"
      }).then(function (resp){
        _this.commentData=resp.data;
      })
    },
    data() {
      return {
        btnText:"隐藏",
        isShow:false,
        commentDatas: [{
          photo:'',
          name: '姜明',
          id:'1',
          text:'津贴喝好圣诞节交罚款哈咖啡壶看不见了都',
          time:'2018-03-27 00:23'
        },
          {
            photo:'',
            name: '李凯翔',
            id:'2',
            text:'我永远喜欢佳人小姐我要到他多个',
            time:'2018-03-27 00:23'
          }
        ],
        rules: {
          desc: [
            { required: true, message: '请填写内容', trigger: 'blur' }
          ]
        }
      }
    },
    methods: {
      showToggle:function(){
        this.isShow = !this.isShow
        if(this.isShow){
          this.btnText = "隐藏"
        }else{
          this.btnText = "显示"
        }
      },
      submitForm(formName) {
        this.$refs[formName].validate((valid) => {
          if (valid) {
            // window.location.href="http://localhost:63342/01-%E5%88%9D%E5%A7%8B%E5%B7%A5%E7%A8%8B/brand-case/src/main/webapp/dome2.html?_ijt=q1568uo09n96m0r6pdrdlgqbis&_ij_reload=RELOAD_ON_SAVE";
            alert('提交成功!');
            this.$refs[formName].resetFields();
          } else {
            console.log('提交失败!!');
            return false;
          }
        });
      },
      resetForm(formName) {
        this.$refs[formName].resetFields();
      }
    }
  })
</script>
</body>
</html>